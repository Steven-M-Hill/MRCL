# Manifold Regularized Causal Learning (MRCL)
R code for Manifold Regularized Causal Learning (MRCL) and scripts to run the analysis presented in:
#### Hill, Oates, Blythe &amp; Mukherjee (2019). Causal Learning via Manifold Regularization. arXiv preprint [arXiv:1612.05678](https://arxiv.org/abs/1612.05678).

### MRCL source code
The file [`mrcl.R`](./code/mrcl.R) in the [code](code) directory contains the source code for running MRCL.  
Functions are documented within this file.  
This code was co-authored with [Umberto NoÃ¨](https://github.com/unoe). 

##### Required installs:
```
install.packages('kernlab')
```

### Manuscript analysis scripts

R scripts and functions to reproduce the results in Section 3 of the [manuscript](https://arxiv.org/abs/1612.05678) are provided in the [code](code) directory.  

To run the analysis scripts, the working directory in R must contain the [code](code) directory and the [data](data) directory.  

Details of the origin of the three data files in the [data](data) directory are provided below.  

The [output](output) directory contains files generated by running the scripts (processed data files, results files and plots in respective directories).  
Only a subset of the results files generated by the scripts are provided as part of this repository - just those files required to generate the figures in the manuscript.

##### Required installs:
```
install.packages('pROC', 'glmnet', 'caret', 'pcalg', 'dplyr', 
                 'kernlab', 'doParallel', 'doRNG', 'ggplot2', 'RColorBrewer')
```

##### Dataset D1: Yeast Gene Expression (Section 3.2 of [manuscript](https://arxiv.org/abs/1612.05678))

###### Data
The yeast gene expression knockout data is due to [Kemmeren et al. (2014)](https://www.cell.com/abstract/S0092-8674(14)00342-0) and is available to download at [The Deleteome webpage](http://deleteome.holstegelab.nl/). We use the file [Kemmeren.RData](http://deleteome.holstegelab.nl/data/downloads/causal_inference/Kemmeren.RData) on the Downloads/causal inference subpage.  
In the file [`experimentFunctions.R`](code/experimentFunctions.R), there is a function `importYeastData` that downloads [Kemmeren.RData](http://deleteome.holstegelab.nl/data/downloads/causal_inference/Kemmeren.RData), extracts the required data and saves the resulting dataset in the [data](data) directory as file [`yeastData.RData`](data/yeastData.RData).

###### Analysis
There are three yeast data experiments. To run each of these:
```
source("code/runMainExperimentsYeastTCPA.R")
```
with the variable `experiment` on [line 5 of runMainExperimentsYeastTCPA.R](https://github.com/Steven-M-Hill/MRCL/blob/b772511d7f5b77f6889b6dc9aef5ad2b03c25ae3/code/runMainExperimentsYeastTCPA.R#L5) set to either "yeast_random", "yeast_row-wise" or "yeast_row-wise_GIES". These correspond to the results shown in Figures 1, 2 and 3 in the [manuscript](https://arxiv.org/abs/1612.05678) respectively. The data used to generate these figures can be found in the files [output/yeast_random/results/collatedResults.RData](output/yeast_random/results/collatedResults.RData), [output/yeast_row-wise/results/collatedResults.RData](output/yeast_row-wise/results/collatedResults.RData) and [output/yeast_row-wise_GIES/results/collatedResults.RData](output/yeast_row-wise_GIES/results/collatedResults.RData).

'R.matlab',--> 
